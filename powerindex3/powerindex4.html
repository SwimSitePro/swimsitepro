<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Swim Power Index</title>
  <style>
    body {
      font-family: Arial;
      padding: 20px;
      max-width: 1050px;
      margin: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f0f0f0;
    }
    select, input {
      width: 90px;
    }
    .bold {
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h2>Swim Power Index Calculator</h2>

  <label>Gender:
    <select id="gender" onchange="calculate()">
      <option value="men">Men</option>
      <option value="women">Women</option>
    </select>
  </label>

  <table id="powerTable">
    <thead>
      <tr>
        <th>#</th>
        <th>Event</th>
        <th>Course</th>
        <th>Time (mm:ss.MM)</th>
        <th>Power Index</th>
        <th>Weight</th>
        <th>Weighted Score</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
    <tfoot>
      <tr>
        <td colspan="6" class="bold">Overall Power Index</td>
        <td id="finalScore" class="bold">-</td>
      </tr>
    </tfoot>
  </table>

  <script>
    // (same eventData as before)
    const eventData = {
      men: {
        SCY: {
    '50FR': [{x: 19.49, y: 1}, {x: 20.05, y: 10}, {x: 20.65, y: 20}, {x: 21.21, y: 30}, {x: 21.75, y: 40}, {x: 22.26, y: 50}, {x: 22.74, y: 60}, {x: 23.21, y: 70}, {x: 23.66, y: 80}, {x: 24.09, y: 90}, {x: 24.52, y: 100}],
    '100FR': [{x: 42.69, y: 1}, {x: 43.93, y: 10}, {x: 45.23, y: 20}, {x: 46.47, y: 30}, {x: 47.64, y: 40}, {x: 48.75, y: 50}, {x: 49.82, y: 60}, {x: 50.84, y: 70}, {x: 51.83, y: 80}, {x: 52.78, y: 90}, {x: 53.70, y: 100}],
    '200FR': [{x: 94.09, y: 1}, {x: 96.83, y: 10}, {x: 99.70, y: 20}, {x: 102.42, y: 30}, {x: 105.00, y: 40}, {x: 107.46, y: 50}, {x: 109.81, y: 60}, {x: 112.07, y: 70}, {x: 114.24, y: 80}, {x: 116.33, y: 90}, {x: 118.35, y: 100}],
    '500FR': [{x: 253.39, y: 1}, {x: 260.77, y: 10}, {x: 268.51, y: 20}, {x: 275.83, y: 30}, {x: 282.78, y: 40}, {x: 289.41, y: 50}, {x: 295.74, y: 60}, {x: 301.82, y: 70}, {x: 307.66, y: 80}, {x: 313.28, y: 90}, {x: 318.72, y: 100}],
    '1000FR': [{x: 530.99, y: 1}, {x: 546.46, y: 10}, {x: 562.68, y: 20}, {x: 578.02, y: 30}, {x: 592.59, y: 40}, {x: 606.47, y: 50}, {x: 619.75, y: 60}, {x: 632.48, y: 70}, {x: 644.71, y: 80}, {x: 656.50, y: 90}, {x: 667.89, y: 100}],
    '1650FR': [{x: 885.99, y: 1}, {x: 911.80, y: 10}, {x: 938.88, y: 20}, {x: 964.47, y: 30}, {x: 988.78, y: 40}, {x: 1011.94, y: 50}, {x: 1034.09, y: 60}, {x: 1055.33, y: 70}, {x: 1075.75, y: 80}, {x: 1095.42, y: 90}, {x: 1114.42, y: 100}],
    '50BK': [{x: 21.49, y: 1}, {x: 22.11, y: 10}, {x: 22.77, y: 20}, {x: 23.39, y: 30}, {x: 23.98, y: 40}, {x: 24.54, y: 50}, {x: 25.08, y: 60}, {x: 25.59, y: 70}, {x: 26.09, y: 80}, {x: 26.56, y: 90}, {x: 27.04, y: 100}],
    '100BK': [{x: 46.39, y: 1}, {x: 47.74, y: 10}, {x: 49.15, y: 20}, {x: 50.49, y: 30}, {x: 51.77, y: 40}, {x: 52.98, y: 50}, {x: 54.14, y: 60}, {x: 55.25, y: 70}, {x: 56.32, y: 80}, {x: 57.35, y: 90}, {x: 58.36, y: 100}],
    '200BK': [{x: 101.49, y: 1}, {x: 104.44, y: 10}, {x: 107.54, y: 20}, {x: 110.48, y: 30}, {x: 113.26, y: 40}, {x: 115.91, y: 50}, {x: 118.45, y: 60}, {x: 120.88, y: 70}, {x: 123.22, y: 80}, {x: 125.48, y: 90}, {x: 127.66, y: 100}],
    '50BR': [{x: 24.45, y: 1}, {x: 25.16, y: 10}, {x: 25.90, y: 20}, {x: 26.61, y: 30}, {x: 27.28, y: 40}, {x: 27.92, y: 50}, {x: 28.53, y: 60}, {x: 29.12, y: 70}, {x: 29.68, y: 80}, {x: 30.22, y: 90}, {x: 30.76, y: 100}],
    '100BR': [{x: 52.59, y: 1}, {x: 54.12, y: 10}, {x: 55.72, y: 20}, {x: 57.24, y: 30}, {x: 58.69, y: 40}, {x: 60.06, y: 50}, {x: 61.38, y: 60}, {x: 62.64, y: 70}, {x: 63.85, y: 80}, {x: 65.02, y: 90}, {x: 66.15, y: 100}],
    '200BR': [{x: 113.99, y: 1}, {x: 117.31, y: 10}, {x: 120.79, y: 20}, {x: 124.08, y: 30}, {x: 127.21, y: 40}, {x: 130.19, y: 50}, {x: 133.04, y: 60}, {x: 135.77, y: 70}, {x: 138.40, y: 80}, {x: 140.93, y: 90}, {x: 143.38, y: 100}],
    '50FL': [{x: 21.25, y: 1}, {x: 21.86, y: 10}, {x: 22.51, y: 20}, {x: 23.13, y: 30}, {x: 23.71, y: 40}, {x: 24.27, y: 50}, {x: 24.80, y: 60}, {x: 25.31, y: 70}, {x: 25.80, y: 80}, {x: 26.27, y: 90}, {x: 26.73, y: 100}],
    '100FL': [{x: 46.09, y: 1}, {x: 47.43, y: 10}, {x: 48.84, y: 20}, {x: 50.17, y: 30}, {x: 51.43, y: 40}, {x: 52.64, y: 50}, {x: 53.79, y: 60}, {x: 54.89, y: 70}, {x: 55.96, y: 80}, {x: 56.98, y: 90}, {x: 57.98, y: 100}],
    '200FL': [{x: 102.99, y: 1}, {x: 105.99, y: 10}, {x: 109.13, y: 20}, {x: 112.11, y: 30}, {x: 114.93, y: 40}, {x: 117.63, y: 50}, {x: 120.20, y: 60}, {x: 122.67, y: 70}, {x: 125.04, y: 80}, {x: 127.33, y: 90}, {x: 129.55, y: 100}],
    '100IM': [{x: 47.29, y: 1}, {x: 48.66, y: 10}, {x: 50.11, y: 20}, {x: 51.47, y: 30}, {x: 52.77, y: 40}, {x: 54.01, y: 50}, {x: 55.19, y: 60}, {x: 56.32, y: 70}, {x: 57.41, y: 80}, {x: 58.46, y: 90}, {x: 59.49, y: 100}],
    '200IM': [{x: 103.99, y: 1}, {x: 107.02, y: 10}, {x: 110.19, y: 20}, {x: 113.20, y: 30}, {x: 116.05, y: 40}, {x: 118.77, y: 50}, {x: 121.37, y: 60}, {x: 123.86, y: 70}, {x: 126.26, y: 80}, {x: 128.57, y: 90}, {x: 130.81, y: 100}],
    '400IM': [{x: 224.99, y: 1}, {x: 231.54, y: 10}, {x: 238.42, y: 20}, {x: 244.92, y: 30}, {x: 251.09, y: 40}, {x: 256.97, y: 50}, {x: 262.60, y: 60}, {x: 267.99, y: 70}, {x: 273.17, y: 80}, {x: 278.17, y: 90}, {x: 283.00, y: 100}]
},
LCM: {
    '50FR': [{x: 22.19, y: 1}, {x: 22.83, y: 10}, {x: 23.51, y: 20}, {x: 24.15, y: 30}, {x: 24.76, y: 40}, {x: 25.34, y: 50}, {x: 25.89, y: 60}, {x: 26.43, y: 70}, {x: 26.94, y: 80}, {x: 27.43, y: 90}, {x: 27.92, y: 100}],
    '100FR': [{x: 48.29, y: 1}, {x: 49.69, y: 10}, {x: 51.17, y: 20}, {x: 52.56, y: 30}, {x: 53.89, y: 40}, {x: 55.15, y: 50}, {x: 56.36, y: 60}, {x: 57.52, y: 70}, {x: 58.63, y: 80}, {x: 59.70, y: 90}, {x: 60.75, y: 100}],
    '200FR': [{x: 107.49, y: 1}, {x: 110.62, y: 10}, {x: 113.90, y: 20}, {x: 117.01, y: 30}, {x: 119.96, y: 40}, {x: 122.77, y: 50}, {x: 125.45, y: 60}, {x: 128.03, y: 70}, {x: 130.51, y: 80}, {x: 132.89, y: 90}, {x: 135.21, y: 100}],
    '400FR': [{x: 227.09, y: 1}, {x: 233.70, y: 10}, {x: 240.64, y: 20}, {x: 247.20, y: 30}, {x: 253.43, y: 40}, {x: 259.37, y: 50}, {x: 265.05, y: 60}, {x: 270.49, y: 70}, {x: 275.72, y: 80}, {x: 280.77, y: 90}, {x: 285.64, y: 100}],
    '800FR': [{x: 465.29, y: 1}, {x: 478.84, y: 10}, {x: 493.06, y: 20}, {x: 506.50, y: 30}, {x: 519.27, y: 40}, {x: 531.43, y: 50}, {x: 543.07, y: 60}, {x: 554.22, y: 70}, {x: 564.94, y: 80}, {x: 575.27, y: 90}, {x: 585.25, y: 100}],
    '1500FR': [{x: 905.09, y: 1}, {x: 931.46, y: 10}, {x: 959.12, y: 20}, {x: 985.26, y: 30}, {x: 1010.09, y: 40}, {x: 1033.76, y: 50}, {x: 1056.38, y: 60}, {x: 1078.08, y: 70}, {x: 1098.94, y: 80}, {x: 1119.04, y: 90}, {x: 1138.44, y: 100}],
    '50BK': [{x: 24.69, y: 1}, {x: 25.40, y: 10}, {x: 26.16, y: 20}, {x: 26.87, y: 30}, {x: 27.55, y: 40}, {x: 28.20, y: 50}, {x: 28.81, y: 60}, {x: 29.40, y: 70}, {x: 29.97, y: 80}, {x: 30.52, y: 90}, {x: 31.06, y: 100}],
    '100BK': [{x: 53.49, y: 1}, {x: 55.04, y: 10}, {x: 56.68, y: 20}, {x: 58.22, y: 30}, {x: 59.69, y: 40}, {x: 61.09, y: 50}, {x: 62.43, y: 60}, {x: 63.71, y: 70}, {x: 64.94, y: 80}, {x: 66.13, y: 90}, {x: 67.29, y: 100}],
    '200BK': [{x: 116.59, y: 1}, {x: 119.98, y: 10}, {x: 123.55, y: 20}, {x: 126.91, y: 30}, {x: 130.11, y: 40}, {x: 133.16, y: 50}, {x: 136.07, y: 60}, {x: 138.87, y: 70}, {x: 141.56, y: 80}, {x: 144.15, y: 90}, {x: 146.65, y: 100}],
    '50BR': [{x: 27.39, y: 1}, {x: 28.18, y: 10}, {x: 29.02, y: 20}, {x: 29.81, y: 30}, {x: 30.56, y: 40}, {x: 31.28, y: 50}, {x: 31.96, y: 60}, {x: 32.62, y: 70}, {x: 33.25, y: 80}, {x: 33.86, y: 90}, {x: 34.46, y: 100}],
    '100BR': [{x: 60.89, y: 1}, {x: 62.66, y: 10}, {x: 64.52, y: 20}, {x: 66.28, y: 30}, {x: 67.95, y: 40}, {x: 69.54, y: 50}, {x: 71.06, y: 60}, {x: 72.52, y: 70}, {x: 73.93, y: 80}, {x: 75.28, y: 90}, {x: 76.59, y: 100}],
    '200BR': [{x: 131.59, y: 1}, {x: 135.42, y: 10}, {x: 139.44, y: 20}, {x: 143.24, y: 30}, {x: 146.85, y: 40}, {x: 150.29, y: 50}, {x: 153.58, y: 60}, {x: 156.74, y: 70}, {x: 159.77, y: 80}, {x: 162.69, y: 90}, {x: 165.52, y: 100}],
    '50FL': [{x: 23.69, y: 1}, {x: 24.38, y: 10}, {x: 25.10, y: 20}, {x: 25.78, y: 30}, {x: 26.43, y: 40}, {x: 27.05, y: 50}, {x: 27.65, y: 60}, {x: 28.21, y: 70}, {x: 28.76, y: 80}, {x: 29.28, y: 90}, {x: 29.80, y: 100}],
    '100FL': [{x: 52.19, y: 1}, {x: 53.71, y: 10}, {x: 55.30, y: 20}, {x: 56.81, y: 30}, {x: 58.24, y: 40}, {x: 59.60, y: 50}, {x: 60.91, y: 60}, {x: 62.16, y: 70}, {x: 63.36, y: 80}, {x: 64.52, y: 90}, {x: 65.65, y: 100}],
    '200FL': [{x: 117.09, y: 1}, {x: 120.50, y: 10}, {x: 124.08, y: 20}, {x: 127.46, y: 30}, {x: 130.67, y: 40}, {x: 133.73, y: 50}, {x: 136.66, y: 60}, {x: 139.47, y: 70}, {x: 142.16, y: 80}, {x: 144.76, y: 90}, {x: 147.28, y: 100}],
    '200IM': [{x: 118.89, y: 1}, {x: 122.35, y: 10}, {x: 125.98, y: 20}, {x: 129.42, y: 30}, {x: 132.68, y: 40}, {x: 135.79, y: 50}, {x: 138.76, y: 60}, {x: 141.61, y: 70}, {x: 144.35, y: 80}, {x: 146.99, y: 90}, {x: 149.55, y: 100}],
    '400IM': [{x: 256.39, y: 1}, {x: 263.86, y: 10}, {x: 271.69, y: 20}, {x: 279.10, y: 30}, {x: 286.13, y: 40}, {x: 292.83, y: 50}, {x: 299.24, y: 60}, {x: 305.39, y: 70}, {x: 311.30, y: 80}, {x: 316.99, y: 90}, {x: 322.50, y: 100}]
},
SCM: {
    '50FR': [{x: 21.29, y: 1}, {x: 21.91, y: 10}, {x: 22.56, y: 20}, {x: 23.17, y: 30}, {x: 23.76, y: 40}, {x: 24.31, y: 50}, {x: 24.84, y: 60}, {x: 25.35, y: 70}, {x: 25.84, y: 80}, {x: 26.32, y: 90}, {x: 26.78, y: 100}],
    '100FR': [{x: 46.59, y: 1}, {x: 47.94, y: 10}, {x: 49.37, y: 20}, {x: 50.71, y: 30}, {x: 51.99, y: 40}, {x: 53.21, y: 50}, {x: 54.37, y: 60}, {x: 55.49, y: 70}, {x: 56.56, y: 80}, {x: 57.60, y: 90}, {x: 58.61, y: 100}],
    '200FR': [{x: 103.49, y: 1}, {x: 106.50, y: 10}, {x: 109.66, y: 20}, {x: 112.65, y: 30}, {x: 115.49, y: 40}, {x: 118.20, y: 50}, {x: 120.78, y: 60}, {x: 123.27, y: 70}, {x: 125.65, y: 80}, {x: 127.95, y: 90}, {x: 130.18, y: 100}],
    '400FR': [{x: 217.19, y: 1}, {x: 223.51, y: 10}, {x: 230.15, y: 20}, {x: 236.43, y: 30}, {x: 242.38, y: 40}, {x: 248.06, y: 50}, {x: 253.49, y: 60}, {x: 258.70, y: 70}, {x: 263.70, y: 80}, {x: 268.53, y: 90}, {x: 273.19, y: 100}],
    '800FR': [{x: 453.99, y: 1}, {x: 467.22, y: 10}, {x: 481.09, y: 20}, {x: 494.20, y: 30}, {x: 506.66, y: 40}, {x: 518.53, y: 50}, {x: 529.88, y: 60}, {x: 540.76, y: 70}, {x: 551.22, y: 80}, {x: 561.30, y: 90}, {x: 571.04, y: 100}],
    '1500FR': [{x: 887.99, y: 1}, {x: 913.86, y: 10}, {x: 941.00, y: 20}, {x: 966.65, y: 30}, {x: 991.01, y: 40}, {x: 1014.23, y: 50}, {x: 1036.46, y: 60}, {x: 1057.71, y: 70}, {x: 1078.18, y: 80}, {x: 1097.89, y: 90}, {x: 1116.93, y: 100}],
    '50BK': [{x: 23.69, y: 1}, {x: 24.38, y: 10}, {x: 25.10, y: 20}, {x: 25.78, y: 30}, {x: 26.43, y: 40}, {x: 27.05, y: 50}, {x: 27.65, y: 60}, {x: 28.21, y: 70}, {x: 28.76, y: 80}, {x: 29.28, y: 90}, {x: 29.80, y: 100}],
    '100BK': [{x: 50.89, y: 1}, {x: 52.37, y: 10}, {x: 53.92, y: 20}, {x: 55.39, y: 30}, {x: 56.79, y: 40}, {x: 58.12, y: 50}, {x: 59.39, y: 60}, {x: 60.61, y: 70}, {x: 61.78, y: 80}, {x: 62.91, y: 90}, {x: 64.02, y: 100}],
    '200BK': [{x: 111.09, y: 1}, {x: 114.32, y: 10}, {x: 117.72, y: 20}, {x: 120.93, y: 30}, {x: 123.97, y: 40}, {x: 126.88, y: 50}, {x: 129.66, y: 60}, {x: 132.32, y: 70}, {x: 134.88, y: 80}, {x: 137.35, y: 90}, {x: 139.74, y: 100}],
    '50BR': [{x: 26.79, y: 1}, {x: 27.57, y: 10}, {x: 28.38, y: 20}, {x: 29.16, y: 30}, {x: 29.89, y: 40}, {x: 30.59, y: 50}, {x: 31.26, y: 60}, {x: 31.91, y: 70}, {x: 32.52, y: 80}, {x: 33.12, y: 90}, {x: 33.70, y: 100}],
    '100BR': [{x: 57.79, y: 1}, {x: 59.47, y: 10}, {x: 61.23, y: 20}, {x: 62.90, y: 30}, {x: 64.49, y: 40}, {x: 66.00, y: 50}, {x: 67.45, y: 60}, {x: 68.83, y: 70}, {x: 70.16, y: 80}, {x: 71.45, y: 90}, {x: 72.69, y: 100}],
    '200BR': [{x: 125.19, y: 1}, {x: 128.83, y: 10}, {x: 132.66, y: 20}, {x: 136.28, y: 30}, {x: 139.71, y: 40}, {x: 142.98, y: 50}, {x: 146.11, y: 60}, {x: 149.11, y: 70}, {x: 152.00, y: 80}, {x: 154.78, y: 90}, {x: 157.47, y: 100}],
    '50FL': [{x: 23.19, y: 1}, {x: 23.86, y: 10}, {x: 24.57, y: 20}, {x: 25.24, y: 30}, {x: 25.88, y: 40}, {x: 26.48, y: 50}, {x: 27.06, y: 60}, {x: 27.62, y: 70}, {x: 28.15, y: 80}, {x: 28.67, y: 90}, {x: 29.17, y: 100}],
    '100FL': [{x: 50.29, y: 1}, {x: 51.75, y: 10}, {x: 53.29, y: 20}, {x: 54.74, y: 30}, {x: 56.12, y: 40}, {x: 57.43, y: 50}, {x: 58.69, y: 60}, {x: 59.90, y: 70}, {x: 61.06, y: 80}, {x: 62.17, y: 90}, {x: 63.26, y: 100}],
    '200FL': [{x: 113.89, y: 1}, {x: 117.20, y: 10}, {x: 120.68, y: 20}, {x: 123.97, y: 30}, {x: 127.10, y: 40}, {x: 130.08, y: 50}, {x: 132.92, y: 60}, {x: 135.65, y: 70}, {x: 138.28, y: 80}, {x: 140.81, y: 90}, {x: 143.26, y: 100}],
    '100IM': [{x: 51.79, y: 1}, {x: 53.29, y: 10}, {x: 54.88, y: 20}, {x: 56.37, y: 30}, {x: 57.79, y: 40}, {x: 59.15, y: 50}, {x: 60.44, y: 60}, {x: 61.68, y: 70}, {x: 62.88, y: 80}, {x: 64.03, y: 90}, {x: 65.15, y: 100}],
    '200IM': [{x: 113.69, y: 1}, {x: 117.00, y: 10}, {x: 120.47, y: 20}, {x: 123.76, y: 30}, {x: 126.88, y: 40}, {x: 129.85, y: 50}, {x: 132.69, y: 60}, {x: 135.42, y: 70}, {x: 138.04, y: 80}, {x: 140.56, y: 90}, {x: 143.01, y: 100}],
    '400IM': [{x: 247.39, y: 1}, {x: 254.59, y: 10}, {x: 262.15, y: 20}, {x: 269.30, y: 30}, {x: 276.09, y: 40}, {x: 282.56, y: 50}, {x: 288.74, y: 60}, {x: 294.67, y: 70}, {x: 300.37, y: 80}, {x: 305.86, y: 90}, {x: 311.18, y: 100}]
}
      },
women: {
    SCY: {
    '50FR': [{x: 22.09, y: 1}, {x: 22.73, y: 10}, {x: 23.40, y: 20}, {x: 24.04, y: 30}, {x: 24.65, y: 40}, {x: 25.23, y: 50}, {x: 25.78, y: 60}, {x: 26.31, y: 70}, {x: 26.82, y: 80}, {x: 27.31, y: 90}, {x: 27.79, y: 100}],
    '100FR': [{x: 48.39, y: 1}, {x: 49.80, y: 10}, {x: 51.27, y: 20}, {x: 52.67, y: 30}, {x: 54.00, y: 40}, {x: 55.26, y: 50}, {x: 56.47, y: 60}, {x: 57.63, y: 70}, {x: 58.75, y: 80}, {x: 59.82, y: 90}, {x: 60.87, y: 100}],
    '200FR': [{x: 104.79, y: 1}, {x: 107.84, y: 10}, {x: 111.04, y: 20}, {x: 114.07, y: 30}, {x: 116.94, y: 40}, {x: 119.68, y: 50}, {x: 122.30, y: 60}, {x: 124.81, y: 70}, {x: 127.23, y: 80}, {x: 129.56, y: 90}, {x: 131.81, y: 100}],
    '500FR': [{x: 280.29, y: 1}, {x: 288.45, y: 10}, {x: 297.02, y: 20}, {x: 305.12, y: 30}, {x: 312.80, y: 40}, {x: 320.13, y: 50}, {x: 327.14, y: 60}, {x: 333.86, y: 70}, {x: 340.32, y: 80}, {x: 346.54, y: 90}, {x: 352.56, y: 100}],
    '1000FR': [{x: 579.99, y: 1}, {x: 596.89, y: 10}, {x: 614.61, y: 20}, {x: 631.36, y: 30}, {x: 647.27, y: 40}, {x: 662.44, y: 50}, {x: 676.94, y: 60}, {x: 690.84, y: 70}, {x: 704.21, y: 80}, {x: 717.09, y: 90}, {x: 729.53, y: 100}],
    '1650FR': [{x: 971.89, y: 1}, {x: 1000.21, y: 10}, {x: 1029.91, y: 20}, {x: 1057.98, y: 30}, {x: 1084.64, y: 40}, {x: 1110.05, y: 50}, {x: 1134.35, y: 60}, {x: 1157.65, y: 70}, {x: 1180.05, y: 80}, {x: 1201.63, y: 90}, {x: 1222.47, y: 100}],
    '50BK': [{x: 24.39, y: 1}, {x: 25.10, y: 10}, {x: 25.84, y: 20}, {x: 26.55, y: 30}, {x: 27.21, y: 40}, {x: 27.85, y: 50}, {x: 28.46, y: 60}, {x: 29.05, y: 70}, {x: 29.61, y: 80}, {x: 30.15, y: 90}, {x: 30.68, y: 100}],
    '100BK': [{x: 52.09, y: 1}, {x: 53.60, y: 10}, {x: 55.19, y: 20}, {x: 56.70, y: 30}, {x: 58.13, y: 40}, {x: 59.49, y: 50}, {x: 60.79, y: 60}, {x: 62.04, y: 70}, {x: 63.24, y: 80}, {x: 64.40, y: 90}, {x: 65.52, y: 100}],
    '200BK': [{x: 113.89, y: 1}, {x: 117.20, y: 10}, {x: 120.68, y: 20}, {x: 123.97, y: 30}, {x: 127.10, y: 40}, {x: 130.08, y: 50}, {x: 132.92, y: 60}, {x: 135.65, y: 70}, {x: 138.28, y: 80}, {x: 140.81, y: 90}, {x: 143.26, y: 100}],
    '50BR': [{x: 27.95, y: 1}, {x: 28.76, y: 10}, {x: 29.61, y: 20}, {x: 30.42, y: 30}, {x: 31.19, y: 40}, {x: 31.92, y: 50}, {x: 32.62, y: 60}, {x: 33.29, y: 70}, {x: 33.93, y: 80}, {x: 34.55, y: 90}, {x: 35.16, y: 100}],
    '100BR': [{x: 59.79, y: 1}, {x: 61.53, y: 10}, {x: 63.35, y: 20}, {x: 65.08, y: 30}, {x: 66.72, y: 40}, {x: 68.29, y: 50}, {x: 69.78, y: 60}, {x: 71.21, y: 70}, {x: 72.59, y: 80}, {x: 73.92, y: 90}, {x: 75.21, y: 100}],
    '200BR': [{x: 129.39, y: 1}, {x: 133.16, y: 10}, {x: 137.11, y: 20}, {x: 140.85, y: 30}, {x: 144.40, y: 40}, {x: 147.78, y: 50}, {x: 151.01, y: 60}, {x: 154.12, y: 70}, {x: 157.10, y: 80}, {x: 159.97, y: 90}, {x: 162.75, y: 100}],
    '50FL': [{x: 24.07, y: 1}, {x: 24.77, y: 10}, {x: 25.50, y: 20}, {x: 26.20, y: 30}, {x: 26.86, y: 40}, {x: 27.49, y: 50}, {x: 28.09, y: 60}, {x: 28.67, y: 70}, {x: 29.22, y: 80}, {x: 29.75, y: 90}, {x: 30.28, y: 100}],
    '100FL': [{x: 51.99, y: 1}, {x: 53.50, y: 10}, {x: 55.09, y: 20}, {x: 56.59, y: 30}, {x: 58.02, y: 40}, {x: 59.38, y: 50}, {x: 60.68, y: 60}, {x: 61.92, y: 70}, {x: 63.12, y: 80}, {x: 64.27, y: 90}, {x: 65.40, y: 100}],
    '200FL': [{x: 115.89, y: 1}, {x: 119.26, y: 10}, {x: 122.80, y: 20}, {x: 126.15, y: 30}, {x: 129.33, y: 40}, {x: 132.36, y: 50}, {x: 135.26, y: 60}, {x: 138.04, y: 70}, {x: 140.71, y: 80}, {x: 143.28, y: 90}, {x: 145.77, y: 100}],
    '100IM': [{x: 52.99, y: 1}, {x: 54.53, y: 10}, {x: 56.15, y: 20}, {x: 57.68, y: 30}, {x: 59.13, y: 40}, {x: 60.52, y: 50}, {x: 61.84, y: 60}, {x: 63.11, y: 70}, {x: 64.33, y: 80}, {x: 65.51, y: 90}, {x: 66.66, y: 100}],
    '200IM': [{x: 116.49, y: 1}, {x: 119.88, y: 10}, {x: 123.44, y: 20}, {x: 126.80, y: 30}, {x: 130.00, y: 40}, {x: 133.05, y: 50}, {x: 135.96, y: 60}, {x: 138.75, y: 70}, {x: 141.44, y: 80}, {x: 144.02, y: 90}, {x: 146.53, y: 100}],
    '400IM': [{x: 249.89, y: 1}, {x: 257.17, y: 10}, {x: 264.80, y: 20}, {x: 272.02, y: 30}, {x: 278.88, y: 40}, {x: 285.41, y: 50}, {x: 291.66, y: 60}, {x: 297.65, y: 70}, {x: 303.41, y: 80}, {x: 308.96, y: 90}, {x: 314.32, y: 100}]
},
LCM: {
    '50FR': [{x: 24.99, y: 1}, {x: 25.71, y: 10}, {x: 26.48, y: 20}, {x: 27.20, y: 30}, {x: 27.88, y: 40}, {x: 28.54, y: 50}, {x: 29.16, y: 60}, {x: 29.76, y: 70}, {x: 30.34, y: 80}, {x: 30.89, y: 90}, {x: 31.44, y: 100}],
    '100FR': [{x: 54.29, y: 1}, {x: 55.87, y: 10}, {x: 57.53, y: 20}, {x: 59.09, y: 30}, {x: 60.58, y: 40}, {x: 62.00, y: 50}, {x: 63.36, y: 60}, {x: 64.66, y: 70}, {x: 65.91, y: 80}, {x: 67.12, y: 90}, {x: 68.29, y: 100}],
    '200FR': [{x: 118.69, y: 1}, {x: 122.14, y: 10}, {x: 125.77, y: 20}, {x: 129.20, y: 30}, {x: 132.46, y: 40}, {x: 135.56, y: 50}, {x: 138.53, y: 60}, {x: 141.37, y: 70}, {x: 144.11, y: 80}, {x: 146.74, y: 90}, {x: 149.30, y: 100}],
    '400FR': [{x: 243.39, y: 1}, {x: 250.48, y: 10}, {x: 257.92, y: 20}, {x: 264.95, y: 30}, {x: 271.62, y: 40}, {x: 277.99, y: 50}, {x: 284.07, y: 60}, {x: 289.91, y: 70}, {x: 295.52, y: 80}, {x: 300.92, y: 90}, {x: 306.15, y: 100}],
    '800FR': [{x: 503.69, y: 1}, {x: 518.36, y: 10}, {x: 533.75, y: 20}, {x: 548.31, y: 30}, {x: 562.12, y: 40}, {x: 575.29, y: 50}, {x: 587.88, y: 60}, {x: 599.96, y: 70}, {x: 611.57, y: 80}, {x: 622.75, y: 90}, {x: 633.56, y: 100}],
    '1500FR': [{x: 994.89, y: 1}, {x: 1023.88, y: 10}, {x: 1054.28, y: 20}, {x: 1083.02, y: 30}, {x: 1110.31, y: 40}, {x: 1136.32, y: 50}, {x: 1161.20, y: 60}, {x: 1185.05, y: 70}, {x: 1207.97, y: 80}, {x: 1230.06, y: 90}, {x: 1251.40, y: 100}],
    '50BK': [{x: 27.99, y: 1}, {x: 28.80, y: 10}, {x: 29.66, y: 20}, {x: 30.46, y: 30}, {x: 31.23, y: 40}, {x: 31.96, y: 50}, {x: 32.66, y: 60}, {x: 33.33, y: 70}, {x: 33.98, y: 80}, {x: 34.60, y: 90}, {x: 35.21, y: 100}],
    '100BK': [{x: 59.89, y: 1}, {x: 61.63, y: 10}, {x: 63.46, y: 20}, {x: 65.19, y: 30}, {x: 66.83, y: 40}, {x: 68.40, y: 50}, {x: 69.90, y: 60}, {x: 71.33, y: 70}, {x: 72.71, y: 80}, {x: 74.04, y: 90}, {x: 75.34, y: 100}],
    '200BK': [{x: 130.59, y: 1}, {x: 134.39, y: 10}, {x: 138.38, y: 20}, {x: 142.15, y: 30}, {x: 145.74, y: 40}, {x: 149.15, y: 50}, {x: 152.42, y: 60}, {x: 155.55, y: 70}, {x: 158.56, y: 80}, {x: 161.45, y: 90}, {x: 164.26, y: 100}],
    '50BR': [{x: 31.39, y: 1}, {x: 32.30, y: 10}, {x: 33.26, y: 20}, {x: 34.17, y: 30}, {x: 35.03, y: 40}, {x: 35.85, y: 50}, {x: 36.63, y: 60}, {x: 37.38, y: 70}, {x: 38.11, y: 80}, {x: 38.81, y: 90}, {x: 39.49, y: 100}],
    '100BR': [{x: 68.79, y: 1}, {x: 70.79, y: 10}, {x: 72.89, y: 20}, {x: 74.88, y: 30}, {x: 76.77, y: 40}, {x: 78.56, y: 50}, {x: 80.28, y: 60}, {x: 81.93, y: 70}, {x: 83.52, y: 80}, {x: 85.05, y: 90}, {x: 86.53, y: 100}],
    '200BR': [{x: 148.29, y: 1}, {x: 152.61, y: 10}, {x: 157.14, y: 20}, {x: 161.42, y: 30}, {x: 165.49, y: 40}, {x: 169.37, y: 50}, {x: 173.07, y: 60}, {x: 176.63, y: 70}, {x: 180.05, y: 80}, {x: 183.34, y: 90}, {x: 186.53, y: 100}],
    '50FL': [{x: 26.69, y: 1}, {x: 27.46, y: 10}, {x: 28.28, y: 20}, {x: 29.05, y: 30}, {x: 29.78, y: 40}, {x: 30.48, y: 50}, {x: 31.15, y: 60}, {x: 31.79, y: 70}, {x: 32.40, y: 80}, {x: 32.99, y: 90}, {x: 33.58, y: 100}],
    '100FL': [{x: 58.69, y: 1}, {x: 60.40, y: 10}, {x: 62.19, y: 20}, {x: 63.88, y: 30}, {x: 65.49, y: 40}, {x: 67.03, y: 50}, {x: 68.50, y: 60}, {x: 69.90, y: 70}, {x: 71.26, y: 80}, {x: 72.56, y: 90}, {x: 73.83, y: 100}],
    '200FL': [{x: 130.39, y: 1}, {x: 134.18, y: 10}, {x: 138.17, y: 20}, {x: 141.94, y: 30}, {x: 145.51, y: 40}, {x: 148.92, y: 50}, {x: 152.18, y: 60}, {x: 155.31, y: 70}, {x: 158.31, y: 80}, {x: 161.21, y: 90}, {x: 164.01, y: 100}],
    '200IM': [{x: 132.29, y: 1}, {x: 136.14, y: 10}, {x: 140.18, y: 20}, {x: 144.00, y: 30}, {x: 147.63, y: 40}, {x: 151.09, y: 50}, {x: 154.40, y: 60}, {x: 157.57, y: 70}, {x: 160.62, y: 80}, {x: 163.56, y: 90}, {x: 166.40, y: 100}],
    '400IM': [{x: 282.99, y: 1}, {x: 291.23, y: 10}, {x: 299.88, y: 20}, {x: 308.05, y: 30}, {x: 315.82, y: 40}, {x: 323.22, y: 50}, {x: 330.29, y: 60}, {x: 337.08, y: 70}, {x: 343.60, y: 80}, {x: 349.88, y: 90}, {x: 355.95, y: 100}]
},
SCM: {
    '50FR': [{x: 24.29, y: 1}, {x: 24.99, y: 10}, {x: 25.74, y: 20}, {x: 26.44, y: 30}, {x: 27.10, y: 40}, {x: 27.74, y: 50}, {x: 28.35, y: 60}, {x: 28.93, y: 70}, {x: 29.49, y: 80}, {x: 30.03, y: 90}, {x: 30.56, y: 100}],
    '100FR': [{x: 53.29, y: 1}, {x: 54.84, y: 10}, {x: 56.47, y: 20}, {x: 58.01, y: 30}, {x: 59.47, y: 40}, {x: 60.86, y: 50}, {x: 62.19, y: 60}, {x: 63.47, y: 70}, {x: 64.70, y: 80}, {x: 65.88, y: 90}, {x: 67.03, y: 100}],
    '200FR': [{x: 115.19, y: 1}, {x: 118.54, y: 10}, {x: 122.06, y: 20}, {x: 125.39, y: 30}, {x: 128.55, y: 40}, {x: 131.56, y: 50}, {x: 134.44, y: 60}, {x: 137.20, y: 70}, {x: 139.86, y: 80}, {x: 142.41, y: 90}, {x: 144.89, y: 100}],
    '400FR': [{x: 243.19, y: 1}, {x: 250.27, y: 10}, {x: 257.70, y: 20}, {x: 264.73, y: 30}, {x: 271.40, y: 40}, {x: 277.76, y: 50}, {x: 283.84, y: 60}, {x: 289.67, y: 70}, {x: 295.27, y: 80}, {x: 300.67, y: 90}, {x: 305.89, y: 100}],
    '800FR': [{x: 499.59, y: 1}, {x: 514.14, y: 10}, {x: 529.41, y: 20}, {x: 543.84, y: 30}, {x: 557.55, y: 40}, {x: 570.61, y: 50}, {x: 583.10, y: 60}, {x: 595.08, y: 70}, {x: 606.59, y: 80}, {x: 617.68, y: 90}, {x: 628.40, y: 100}],
    '1500FR': [{x: 974.59, y: 1}, {x: 1002.99, y: 10}, {x: 1032.77, y: 20}, {x: 1060.92, y: 30}, {x: 1087.66, y: 40}, {x: 1113.14, y: 50}, {x: 1137.50, y: 60}, {x: 1160.87, y: 70}, {x: 1183.33, y: 80}, {x: 1204.96, y: 90}, {x: 1225.86, y: 100}],
    '50BK': [{x: 26.79, y: 1}, {x: 27.57, y: 10}, {x: 28.38, y: 20}, {x: 29.16, y: 30}, {x: 29.89, y: 40}, {x: 30.59, y: 50}, {x: 31.26, y: 60}, {x: 31.91, y: 70}, {x: 32.52, y: 80}, {x: 33.12, y: 90}, {x: 33.70, y: 100}],
    '100BK': [{x: 57.19, y: 1}, {x: 58.85, y: 10}, {x: 60.60, y: 20}, {x: 62.25, y: 30}, {x: 63.82, y: 40}, {x: 65.32, y: 50}, {x: 66.75, y: 60}, {x: 68.12, y: 70}, {x: 69.43, y: 80}, {x: 70.70, y: 90}, {x: 71.94, y: 100}],
    '200BK': [{x: 125.69, y: 1}, {x: 129.35, y: 10}, {x: 133.19, y: 20}, {x: 136.82, y: 30}, {x: 140.27, y: 40}, {x: 143.55, y: 50}, {x: 146.70, y: 60}, {x: 149.71, y: 70}, {x: 152.61, y: 80}, {x: 155.40, y: 90}, {x: 158.10, y: 100}],
    '50BR': [{x: 30.49, y: 1}, {x: 31.37, y: 10}, {x: 32.31, y: 20}, {x: 33.19, y: 30}, {x: 34.02, y: 40}, {x: 34.82, y: 50}, {x: 35.58, y: 60}, {x: 36.31, y: 70}, {x: 37.02, y: 80}, {x: 37.69, y: 90}, {x: 38.36, y: 100}],
    '100BR': [{x: 65.19, y: 1}, {x: 67.08, y: 10}, {x: 69.08, y: 20}, {x: 70.96, y: 30}, {x: 72.75, y: 40}, {x: 74.45, y: 50}, {x: 76.08, y: 60}, {x: 77.65, y: 70}, {x: 79.15, y: 80}, {x: 80.59, y: 90}, {x: 82.00, y: 100}],
    '200BR': [{x: 140.99, y: 1}, {x: 145.09, y: 10}, {x: 149.40, y: 20}, {x: 153.47, y: 30}, {x: 157.34, y: 40}, {x: 161.03, y: 50}, {x: 164.55, y: 60}, {x: 167.93, y: 70}, {x: 171.18, y: 80}, {x: 174.31, y: 90}, {x: 177.34, y: 100}],
    '50FL': [{x: 26.19, y: 1}, {x: 26.95, y: 10}, {x: 27.75, y: 20}, {x: 28.51, y: 30}, {x: 29.22, y: 40}, {x: 29.91, y: 50}, {x: 30.56, y: 60}, {x: 31.19, y: 70}, {x: 31.79, y: 80}, {x: 32.38, y: 90}, {x: 32.95, y: 100}],
    '100FL': [{x: 57.19, y: 1}, {x: 58.85, y: 10}, {x: 60.60, y: 20}, {x: 62.25, y: 30}, {x: 63.82, y: 40}, {x: 65.32, y: 50}, {x: 66.75, y: 60}, {x: 68.12, y: 70}, {x: 69.43, y: 80}, {x: 70.70, y: 90}, {x: 71.94, y: 100}],
    '200FL': [{x: 127.09, y: 1}, {x: 130.79, y: 10}, {x: 134.67, y: 20}, {x: 138.34, y: 30}, {x: 141.83, y: 40}, {x: 145.15, y: 50}, {x: 148.33, y: 60}, {x: 151.38, y: 70}, {x: 154.31, y: 80}, {x: 157.13, y: 90}, {x: 159.86, y: 100}],
    '100IM': [{x: 58.19, y: 1}, {x: 59.88, y: 10}, {x: 61.66, y: 20}, {x: 63.34, y: 30}, {x: 64.94, y: 40}, {x: 66.46, y: 50}, {x: 67.91, y: 60}, {x: 69.31, y: 70}, {x: 70.65, y: 80}, {x: 71.94, y: 90}, {x: 73.20, y: 100}],
    '200IM': [{x: 128.49, y: 1}, {x: 132.23, y: 10}, {x: 136.16, y: 20}, {x: 139.87, y: 30}, {x: 143.39, y: 40}, {x: 146.75, y: 50}, {x: 149.96, y: 60}, {x: 153.04, y: 70}, {x: 156.01, y: 80}, {x: 158.86, y: 90}, {x: 161.62, y: 100}],
    '400IM': [{x: 275.09, y: 1}, {x: 283.10, y: 10}, {x: 291.51, y: 20}, {x: 299.45, y: 30}, {x: 307.00, y: 40}, {x: 314.19, y: 50}, {x: 321.07, y: 60}, {x: 327.67, y: 70}, {x: 334.00, y: 80}, {x: 340.11, y: 90}, {x: 346.02, y: 100}]
}    
}
    };

    const availableEvents = Object.keys(eventData['men']['SCY']);
    const availableCourses = ['SCY', 'LCM', 'SCM'];
    const weightByRank = [1.0, 1.0, 0.25, 0.02, 0.0];

    function computeCoefficients(points) {
      const n = points.length;
      const a = points.map(p => p.y);
      for (let j = 1; j < n; j++) {
        for (let i = n - 1; i >= j; i--) {
          a[i] = (a[i] - a[i - 1]) / (points[i].x - points[i - j].x);
        }
      }
      return a;
    }

    function evaluatePolynomial(a, points, x) {
      let result = a[a.length - 1];
      for (let i = a.length - 2; i >= 0; i--) {
        result = result * (x - points[i].x) + a[i];
      }
      return result;
    }

    function parseTime(str) {
      if (!str) return NaN;
      const parts = str.split(':');
      if (parts.length === 1) {
        return parseFloat(parts[0]);
      } else if (parts.length === 2) {
        const min = parseFloat(parts[0]);
        const sec = parseFloat(parts[1]);
        if (isNaN(min) || isNaN(sec)) return NaN;
        return min * 60 + sec;
      } else {
        return NaN;
      }
    }

    function formatTime(seconds) {
      if (isNaN(seconds)) return "";
      const min = Math.floor(seconds / 60);
      const sec = (seconds % 60).toFixed(2).padStart(5, '0');
      return `${min}:${sec}`;
    }

    function calculatePowerIndex(gender, course, event, time) {
      const points = eventData[gender]?.[course]?.[event];
      if (!points || isNaN(time)) return 100;
      const a = computeCoefficients(points);
      let pi = evaluatePolynomial(a, points, time);
      return Math.max(1, Math.min(100, pi));
    }

    function buildTableInputs() {
      const tbody = document.getElementById("tableBody");
      tbody.innerHTML = '';
      for (let i = 0; i < 5; i++) {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td class="rowNum">${i + 1}</td>
          <td>
            <select onchange="calculate()" class="eventSelect">
              ${availableEvents.map(e => `<option value="${e}">${e}</option>`).join('')}
            </select>
          </td>
          <td>
            <select onchange="calculate()" class="courseSelect">
              ${availableCourses.map(c => `<option value="${c}">${c}</option>`).join('')}
            </select>
          </td>
          <td><input type="text" onblur="formatInput(this); calculate()" class="timeInput" placeholder="mm:ss.MM" /></td>
          <td class="pi">-</td>
          <td class="weight">-</td>
          <td class="wscore">-</td>
        `;
        tbody.appendChild(row);
      }
    }

    function formatInput(input) {
      const time = parseTime(input.value);
      if (!isNaN(time)) {
        input.value = formatTime(time);
      }
    }

    function calculate() {
      const gender = document.getElementById("gender").value;
      const tbody = document.getElementById("tableBody");
      const rows = Array.from(tbody.querySelectorAll("tr"));

      const entries = rows.map((row, index) => {
        const event = row.querySelector(".eventSelect").value;
        const course = row.querySelector(".courseSelect").value;
        const timeInput = row.querySelector(".timeInput");
        const time = parseTime(timeInput.value);
        const pi = calculatePowerIndex(gender, course, event, time);
        return {
          row,
          event,
          course,
          time,
          timeDisplay: formatTime(time),
          pi,
          timeInput,
          eventSelect: event,
          courseSelect: course
        };
      });

      entries.sort((a, b) => a.pi - b.pi);

      let totalScore = 0;
      let totalWeight = 0;
      tbody.innerHTML = '';

      entries.forEach((entry, rank) => {
        const newRow = document.createElement("tr");
        const weight = weightByRank[rank];
        const wScore = entry.pi * weight;

        newRow.innerHTML = `
          <td class="rowNum">${rank + 1}</td>
          <td>
            <select onchange="calculate()" class="eventSelect">
              ${availableEvents.map(e => `<option value="${e}" ${e === entry.eventSelect ? 'selected' : ''}>${e}</option>`).join('')}
            </select>
          </td>
          <td>
            <select onchange="calculate()" class="courseSelect">
              ${availableCourses.map(c => `<option value="${c}" ${c === entry.courseSelect ? 'selected' : ''}>${c}</option>`).join('')}
            </select>
          </td>
          <td><input type="text" value="${entry.timeDisplay}" onblur="formatInput(this); calculate()" class="timeInput" /></td>
          <td class="pi">${entry.pi.toFixed(2)}</td>
          <td class="weight">${(weight * 100).toFixed(0)}%</td>
          <td class="wscore">${wScore.toFixed(2)}</td>
        `;
        tbody.appendChild(newRow);

        totalScore += wScore;
        totalWeight += weight;
      });

      const final = totalScore / totalWeight;
      document.getElementById("finalScore").textContent = isFinite(final) ? final.toFixed(2) : "-";
    }

    buildTableInputs();
    calculate();
  </script>

</body>
</html>
